<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Vocabulary Station</title>

<style>

/* DARK METAL GRAY BACKGROUND + WHITE TEXT */
body {
    background: linear-gradient(135deg, #2b2b2b, #1f1f1f, #2a2a2a);
    color: white;
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
}

/* UNIVERSAL ACTIVITY COLORS */
.ordering-theme { background: #00B0FF20; border-left: 6px solid #00B0FF; }
.matching-theme { background: #AB47BC20; border-left: 6px solid #AB47BC; }
.trivia-theme { background: #4CAF5020; border-left: 6px solid #4CAF50; }
.fill-theme { background: #EF535020; border-left: 6px solid #EF5350; }
.builder-theme { background: #FDD83520; border-left: 6px solid #FDD835; }
.listen-theme { background: #FFA72620; border-left: 6px solid #FFA726; }
.read-theme { background: #5C6BC020; border-left: 6px solid #5C6BC0; }
.speak-theme { background: #26C6DA20; border-left: 6px solid #26C6DA; }

/* FIXED BOTTOM BAR ‚Äî PURPLE */
.fixed-bar {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    background: #6A1B9A;
    padding: 12px;
    display: flex;
    justify-content: center;
    gap: 20px;
    z-index: 9999;
    border-top: 2px solid #4A0072;
    backdrop-filter: blur(6px);
}

/* YELLOW BUTTONS */
.bar-btn {
    background: #FFEB3B;
    color: #1A1A1A;
    padding: 10px 20px;
    border-radius: 10px;
    border: none;
    cursor: pointer;
    font-size: 16px;
}
.bar-btn:hover { background: #FBC02D; color: black; }

/* GENERAL LAYOUT */
.screen {
    display: none;
    padding: 30px;
    margin-bottom: 100px;
    border-radius: 12px;
}
#main {
    padding: 30px;
    margin-bottom: 100px;
}
button {
    padding: 12px 20px;
    margin: 10px;
    border-radius: 10px;
    border: none;
    background: #4FC3F7;
    cursor: pointer;
    font-size: 18px;
    color: black;
}
button:hover { background: #0288D1; color: white; }

/* ========================= */
/* UNIVERSAL HUD CSS */
/* ========================= */

#progress-container {
    width: 100%;
    height: 12px;
    background: #444;
    border-bottom: 2px solid #222;
}
#progress-bar {
    width: 0%;
    height: 100%;
    background: #FFEB3B;
    transition: width 0.4s ease;
}

#hud-row {
    display: flex;
    gap: 10px;
    padding: 10px 20px;
}

#score-box {
    padding: 10px 20px;
    font-size: 20px;
    background: #6A1B9A;
    border-radius: 10px;
}

#timer-box {
    padding: 10px 20px;
    font-size: 20px;
    background: #AB47BC;
    border-radius: 10px;
}

#tip-box {
    position: fixed;
    top: 20px;
    right: 20px;
    background: #333;
    padding: 15px 20px;
    border-radius: 10px;
    border: 2px solid #FFEB3B;
    font-size: 16px;
    max-width: 250px;
    color: white;
    z-index: 9999;
}

</style>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>THE PIT ‚Äì Games Station</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&display=swap" rel="stylesheet">
  <title>Games Station</title>
  <style>
    :root{--bg1:#dbeafe;--bg2:#2563eb;--bg3:#0b1a44;--ink:#0f172a;--panel:#f8fafc;--line:#bfdbfe;--brand:#1d4ed8;--ok:#166534;--bad:#991b1b}
    :root{
      --bg:#eaf2ff;
      --panel:#ffffff;
      --line:#bfd7ff;
      --ink:#102a52;
      --blue:#2563eb;
      --blue-soft:#dbeafe;
      --ok:#166534;
      --bad:#991b1b;
    }

    *{box-sizing:border-box}
    body{margin:0;font-family:'Orbitron',sans-serif;background:radial-gradient(circle,var(--bg1) 0%,var(--bg2) 56%,var(--bg3) 100%);color:var(--ink)}
    .app{width:min(1120px,95vw);margin:14px auto 92px;background:#fff;border-radius:20px;padding:14px;box-shadow:0 18px 42px rgba(2,6,23,.45)}
    h1{margin:0;text-align:center;color:#1e3a8a;font-size:clamp(20px,4vw,30px)}
    .sub{margin:6px 0 10px;text-align:center;color:var(--brand);font-size:12px}
    body{
      margin:0;
      font-family:Arial, Helvetica, sans-serif;
      background:linear-gradient(180deg,#eaf2ff 0%, #dbeafe 100%);
      color:var(--ink);
    }

    .app{
      width:min(980px,95vw);
      margin:12px auto 90px;
      background:var(--panel);
      border:2px solid var(--line);
      border-radius:14px;
      padding:14px;
      box-shadow:0 12px 30px rgba(37,99,235,.15);
    }

    h1{margin:0 0 6px;text-align:center;color:#1e3a8a;font-size:clamp(20px,4vw,30px)}
    .subtitle{text-align:center;margin:0 0 12px;font-size:14px;color:#1d4ed8;line-height:1.45}

    .hud{display:grid;grid-template-columns:repeat(4,minmax(120px,1fr));gap:8px;margin-bottom:10px}
    .box{background:#eff6ff;border:2px solid #93c5fd;border-radius:10px;padding:9px;font-size:12px;font-weight:800;color:#1e3a8a}
    .tip{background:#ecfeff;border:2px solid #67e8f9;border-radius:10px;padding:10px;font-size:12px;color:#0f766e;margin-bottom:10px}
    .hud{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:8px;margin-bottom:12px}
    .box{background:#eff6ff;border:2px solid #93c5fd;border-radius:10px;padding:10px;font-weight:700;font-size:14px}

    .gameMenu{display:grid;grid-template-columns:repeat(4,minmax(150px,1fr));gap:8px;margin-bottom:10px}
    .gameBtn{border:2px solid var(--line);background:#fff;color:#1e3a8a;border-radius:10px;padding:10px;font-family:inherit;font-size:11px;font-weight:800;cursor:pointer;text-align:left}
    .gameBtn.active{background:#dbeafe;border-color:#2563eb}
    .help{background:#ecfeff;border:2px solid #67e8f9;border-radius:10px;padding:10px;margin-bottom:12px;font-size:13px;line-height:1.4}

    .panel{display:none;background:var(--panel);border:2px solid #cbd5e1;border-radius:12px;padding:12px}
    .menu{display:grid;grid-template-columns:repeat(auto-fit,minmax(170px,1fr));gap:8px;margin-bottom:12px}
    .menuBtn{border:2px solid var(--line);background:#fff;border-radius:10px;padding:10px;cursor:pointer;text-align:left;font-weight:700;color:#1e3a8a;min-height:70px}
    .menuBtn.active{background:var(--blue-soft);border-color:var(--blue)}
    .menuBtn small{display:block;color:#334155;font-weight:600;margin-top:4px;line-height:1.3}

    .panel{display:none;background:#f8fbff;border:2px solid #dbeafe;border-radius:12px;padding:12px}
    .panel.active{display:block}
    .panel h2{margin:0 0 8px;color:#1e3a8a;font-size:15px}
    .question{font-size:13px;margin:6px 0 8px}
    .panel h2{margin:0 0 8px;font-size:18px;color:#1e3a8a}
    .bank{background:#f0f9ff;border:2px dashed #7dd3fc;border-radius:10px;padding:10px;margin-bottom:10px}
    .bank strong{display:block;margin-bottom:6px}
    .bank ul{margin:0;padding-left:18px}
    .bank li{font-size:13px;line-height:1.45}

    .question{font-size:15px;font-weight:700;margin:8px 0}
    .answers{display:grid;gap:8px}
    .answers button{border:2px solid var(--line);background:#fff;color:#1e3a8a;border-radius:10px;padding:10px;font-family:inherit;font-size:11px;font-weight:800;text-align:left;cursor:pointer}
    .answers button:disabled{opacity:.85;cursor:not-allowed}
    .answers button.correct{background:#dcfce7;border-color:#22c55e;color:var(--ok)}
    .answers button.wrong{background:#fee2e2;border-color:#ef4444;color:var(--bad)}
    .feedback{min-height:18px;margin-top:8px;font-size:12px;font-weight:800}
    .ok{color:var(--ok)} .bad{color:var(--bad)}
    .row{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .btn{border:0;border-radius:10px;padding:9px 12px;font-family:inherit;font-size:11px;font-weight:900;cursor:pointer}
    .primary{background:#2563eb;color:#fff}
    .soft{background:#e2e8f0;color:#0f172a}

    .pairsBoard{display:grid;grid-template-columns:repeat(4,minmax(66px,1fr));gap:8px}
    .pairCard{height:62px;border:2px solid var(--line);background:#dbeafe;border-radius:10px;font-family:inherit;font-size:11px;font-weight:800;color:#1e3a8a;cursor:pointer}
    .pairCard.open,.pairCard.matched{background:#fff}
    .pairCard.matched{border-color:#22c55e;color:#166534}

    .wheelCard{background:#eff6ff;border:2px dashed #93c5fd;border-radius:10px;padding:12px;font-size:12px;font-weight:800;color:#1e3a8a;min-height:54px}

    .anagramWord{font-size:13px;font-weight:900;color:#1e3a8a;margin:6px 0}
    .anagramInput{width:100%;border:2px solid var(--line);border-radius:10px;padding:10px;font-family:inherit;font-size:12px}

    .fixed{position:fixed;left:0;right:0;bottom:0;background:#0f172a;border-top:2px solid #1e293b;padding:8px;display:flex;justify-content:center;gap:8px;flex-wrap:wrap;z-index:20}
    .fixed button{border:0;border-radius:10px;padding:8px 10px;background:#dbeafe;color:#1e3a8a;font-family:inherit;font-size:11px;font-weight:900;cursor:pointer}

    @media (max-width:900px){.gameMenu{grid-template-columns:repeat(2,minmax(140px,1fr))}}
    @media (max-width:680px){
      .app{padding:10px;margin:8px auto 84px}
      .hud{grid-template-columns:repeat(2,minmax(120px,1fr))}
      .box,.tip{font-size:11px}
      .question{font-size:12px}
      .answers button,.gameBtn,.btn,.fixed button{font-size:10px}
      .pairsBoard{grid-template-columns:repeat(4,minmax(56px,1fr));gap:6px}
      .pairCard{height:56px;font-size:10px}
    .answers button,.btn{
      border:2px solid var(--line);
      background:#fff;
      border-radius:10px;
      padding:10px;
      font-size:14px;
      cursor:pointer;
      text-align:left;
      color:#1e3a8a;
      font-weight:700;
    }
    .btnRow{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .btn.primary{background:var(--blue);color:#fff;border-color:var(--blue)}

    .feedback{min-height:22px;margin-top:8px;font-size:14px;font-weight:700}
    .ok{color:var(--ok)}
    .bad{color:var(--bad)}

    .wordBig{font-size:22px;letter-spacing:2px;font-weight:800;color:#1e3a8a;margin:8px 0;word-break:break-word}
    .input{width:100%;padding:10px;border:2px solid var(--line);border-radius:10px;font-size:15px}

    .fixed{position:fixed;left:0;right:0;bottom:0;background:#0f172a;padding:8px;border-top:2px solid #1e293b;display:flex;justify-content:center;gap:8px;flex-wrap:wrap}
    .fixed button{border:0;border-radius:10px;padding:10px 12px;background:#dbeafe;color:#1e3a8a;font-weight:700;cursor:pointer}

    @media (max-width:640px){
      .app{padding:10px;margin:8px auto 92px}
      .box,.help,.bank li,.question,.feedback,.answers button,.btn,.input{font-size:13px}
      .wordBig{font-size:18px}
    }
  </style>
</head>

<body>

<!-- ========================= -->
<!-- UNIVERSAL HUD BLOCK -->
<!-- ========================= -->

<div id="progress-container">
    <div id="progress-bar"></div>
</div>

<div id="hud-row">
    <div id="score-box">Score: <span id="score">0</span></div>
    <div id="timer-box">Time: <span id="timer">00:00</span></div>
</div>

<div id="tip-box">
    <strong>Tip:</strong> <span id="tip-text">Choose an activity to begin!</span>
</div>

<!-- ========================= -->
<!-- END HUD BLOCK -->
<!-- ========================= -->

<!-- FIXED BOTTOM BAR -->
<div class="fixed-bar">
    <button class="bar-btn" onclick="goBack()">Back</button>
    <button class="bar-btn" onclick="location.href='../index.html'">Main Menu</button>
    <button class="bar-btn" onclick="alert('Paused')">Pause</button>
</div>

<!-- MAIN MENU -->
<div id="main">
    <h1>Vocabulary Station</h1>
    <button onclick="openScreen('matching')">Matching</button>
    <button onclick="openScreen('ordering')">Ordering</button>
    <button onclick="openScreen('fill')">Fill in the Blanks</button>
</div>

<!-- MATCHING -->
<div id="matching" class="screen matching-theme">
    <h2>Matching Activity</h2>
    <p>Match the words with their definitions.</p>
</div>

<!-- ORDERING -->
<div id="ordering" class="screen ordering-theme">
    <h2>Ordering Activity</h2>
    <p>Put the words in the correct order.</p>
</div>

<!-- FILL IN THE BLANKS -->
<div id="fill" class="screen fill-theme">
    <h2>Fill in the Blanks</h2>
    <p>Complete the sentences with the correct words.</p>
</div>
  <main class="app">
    <h1>GAMES STATION</h1>
    <p class="sub">Visible working apps: Quiz ‚Ä¢ Matching Pairs ‚Ä¢ Spin Wheel ‚Ä¢ Anagram</p>
    <h1>Games Station</h1>
    <p class="subtitle">Simple version: 5 games only. Each game has one clear language focus and content bank.</p>

    <section class="hud">
      <div class="box">SCORE: <span id="score">0</span></div>
      <div class="box">STARS: <span id="stars">0</span></div>
      <div class="box">TIME: <span id="timer">00:00</span></div>
      <div class="box">BEST APP: <span id="best">-</span></div>
      <div class="box">Score: <span id="score">0</span></div>
      <div class="box">Stars: <span id="stars">0</span></div>
      <div class="box">Time: <span id="timer">00:00</span></div>
      <div class="box">Current game: <span id="currentGame">Vocabulary Match</span></div>
    </section>

    <div class="tip"><strong>Tip:</strong> <span id="tip">Open any app and play. Each app gives points and stars.</span></div>
    <div class="help"><strong>How it works:</strong> Choose one game. Read the small Language Bank in that game. Complete tasks to earn points.</div>

    <section class="gameMenu" id="gameMenu">
      <button class="gameBtn active" data-panel="quiz">üìù Quiz App<br><small>3-question skill check</small></button>
      <button class="gameBtn" data-panel="pairs">üÉè Matching Pairs App<br><small>memory + vocabulary</small></button>
      <button class="gameBtn" data-panel="wheel">üéØ Spin Wheel App<br><small>random speaking/writing tasks</small></button>
      <button class="gameBtn" data-panel="anagram">üî§ Anagram App<br><small>unscramble words</small></button>
    <section class="menu">
      <button class="menuBtn active" data-panel="vocab">1) Vocabulary Match <small>Focus: Vocabulary</small></button>
      <button class="menuBtn" data-panel="grammar">2) Grammar Choice <small>Focus: Grammar</small></button>
      <button class="menuBtn" data-panel="spelling">3) Spelling Builder <small>Focus: Spelling</small></button>
      <button class="menuBtn" data-panel="pronunciation">4) Pronunciation Trainer <small>Focus: Pronunciation</small></button>
      <button class="menuBtn" data-panel="wordorder">5) Word Order Fix <small>Focus: Word Order</small></button>
    </section>

    <section id="panel-quiz" class="panel active">
      <h2>Quiz App</h2>
      <p id="quizQuestion" class="question"></p>
      <div id="quizAnswers" class="answers"></div>
      <div id="quizFeedback" class="feedback"></div>
      <div class="row">
        <button class="btn primary" id="quizNext" disabled>Next Question</button>
        <button class="btn soft" id="quizRestart">Restart Quiz</button>
    <section id="panel-vocab" class="panel active">
      <h2>Vocabulary Match</h2>
      <div class="bank">
        <strong>Language Bank (Vocabulary)</strong>
        <ul>
          <li>book = libro</li>
          <li>teacher = profesor/profesora</li>
          <li>homework = tarea</li>
        </ul>
      </div>
      <p id="vocabQuestion" class="question"></p>
      <div id="vocabAnswers" class="answers"></div>
      <p id="vocabFeedback" class="feedback"></p>
      <div class="btnRow"><button id="vocabNext" class="btn">Next Word</button></div>
    </section>

    <section id="panel-pairs" class="panel">
      <h2>Matching Pairs App</h2>
      <div id="pairsBoard" class="pairsBoard"></div>
      <div id="pairsFeedback" class="feedback"></div>
      <div class="row">
        <button class="btn soft" id="pairsRestart">Restart Pairs</button>
    <section id="panel-grammar" class="panel">
      <h2>Grammar Choice</h2>
      <div class="bank">
        <strong>Language Bank (Grammar)</strong>
        <ul>
          <li>She/He/It + verb-s</li>
          <li>because = reason</li>
          <li>although = contrast</li>
        </ul>
      </div>
      <p id="grammarQuestion" class="question"></p>
      <div id="grammarAnswers" class="answers"></div>
      <p id="grammarFeedback" class="feedback"></p>
      <div class="btnRow"><button id="grammarNext" class="btn">Next Grammar Item</button></div>
    </section>

    <section id="panel-wheel" class="panel">
      <h2>Spin Wheel App</h2>
      <div id="wheelResult" class="wheelCard">Press SPIN to get a challenge.</div>
      <div id="wheelFeedback" class="feedback"></div>
      <div class="row">
        <button class="btn primary" id="wheelSpin">SPIN</button>
    <section id="panel-spelling" class="panel">
      <h2>Spelling Builder</h2>
      <div class="bank">
        <strong>Language Bank (Spelling)</strong>
        <ul>
          <li>vocabulary</li>
          <li>sentence</li>
          <li>translation</li>
        </ul>
      </div>
      <div id="spellingWord" class="wordBig"></div>
      <input id="spellingInput" class="input" placeholder="Type correct spelling" />
      <p id="spellingFeedback" class="feedback"></p>
      <div class="btnRow">
        <button id="spellingCheck" class="btn primary">Check</button>
        <button id="spellingNext" class="btn">Next Word</button>
      </div>
    </section>

    <section id="panel-pronunciation" class="panel">
      <h2>Pronunciation Trainer</h2>
      <div class="bank">
        <strong>Language Bank (Pronunciation)</strong>
        <ul>
          <li>th in <em>think</em></li>
          <li>v in <em>vocabulary</em></li>
          <li>word stress in <em>trans-LA-tion</em></li>
        </ul>
      </div>
      <p id="pronQuestion" class="question"></p>
      <div id="pronAnswers" class="answers"></div>
      <p id="pronFeedback" class="feedback"></p>
      <div class="btnRow"><button id="pronNext" class="btn">Next Pronunciation Task</button></div>
    </section>

    <section id="panel-anagram" class="panel">
      <h2>Anagram App</h2>
      <p class="question">Unscramble this word:</p>
      <div id="anagramWord" class="anagramWord">-</div>
      <input id="anagramInput" class="anagramInput" placeholder="Type your answer" />
      <div id="anagramFeedback" class="feedback"></div>
      <div class="row">
        <button class="btn primary" id="anagramCheck">Check</button>
        <button class="btn soft" id="anagramNext">Next Anagram</button>
    <section id="panel-wordorder" class="panel">
      <h2>Word Order Fix</h2>
      <div class="bank">
        <strong>Language Bank (Word Order)</strong>
        <ul>
          <li>Subject + adverb + verb + complement</li>
          <li>I always read at night.</li>
          <li>She usually arrives on time.</li>
        </ul>
      </div>
      <p id="orderQuestion" class="question"></p>
      <div id="orderAnswers" class="answers"></div>
      <p id="orderFeedback" class="feedback"></p>
      <div class="btnRow"><button id="orderNext" class="btn">Next Sentence</button></div>
    </section>
  </main>

  <div class="fixed">
    <button onclick="location.href='../index.html'">Main Menu</button>
    <button id="pauseBtn">Pause/Resume Timer</button>
    <button id="resetBtn">Reset Score</button>
  </div>

<script>
  const state = { score:0, stars:0, seconds:0, paused:false, timerRef:null };

/* SCREEN NAVIGATION */
function openScreen(id) {
    document.querySelectorAll('.screen, #main').forEach(s => s.style.display = 'none');
    document.getElementById(id).style.display = 'block';

    setTip("Complete the activity to earn points!");
    startTimer();
    setProgress(20);
}

function goBack() {
    document.querySelectorAll('.screen').forEach(s => s.style.display = 'none');
    document.getElementById('main').style.display = 'block';

    stopTimer();
    setTip("Choose an activity to begin!");
    setProgress(0);
}

/* ========================= */
/* UNIVERSAL HUD JS */
/* ========================= */

function setProgress(percent) {
    document.getElementById("progress-bar").style.width = percent + "%";
}

let score = 0;
function addScore(points) {
    score += points;
    document.getElementById("score").textContent = score;
}

let time = 0;
let timerInterval;

function startTimer() {
    stopTimer();
    time = 0;
    timerInterval = setInterval(() => {
        time++;
        let minutes = String(Math.floor(time / 60)).padStart(2, '0');
        let seconds = String(time % 60).padStart(2, '0');
        document.getElementById("timer").textContent = `${minutes}:${seconds}`;
    }, 1000);
}

function stopTimer() {
    clearInterval(timerInterval);
}

function setTip(text) {
    document.getElementById("tip-text").textContent = text;
}

  const state = {
    score: 0,
    stars: 0,
    best: '-',
    seconds: 0,
    paused: false,
    timerRef: null,
    quizIndex: 0,
    quizCorrect: 0,
    quizAnswered: false,
    pairsDeck: [],
    pairsOpen: [],
    anagramIndex: 0
  };

  const saved = JSON.parse(localStorage.getItem('pitGamesV4') || '{}');
  state.score = saved.score || 0;
  state.stars = saved.stars || 0;
  state.best = saved.best || '-';

  const quizData = [
    {q:'Choose the correct sentence.', options:['She go to school.','She goes to school.','She going school.','She gone school.'], correct:1},
    {q:'Past simple of "eat" is...', options:['eat','eaten','ate','eated'], correct:2},
    {q:'Best contrast connector is...', options:['because','although','and','so'], correct:1}
  const vocabData = [
    {q:'Choose the best translation for "teacher".', options:['profesor','ventana','manzana'], correct:0},
    {q:'Choose the best translation for "homework".', options:['puerta','tarea','agua'], correct:1},
    {q:'Choose the best translation for "book".', options:['libro','mesa','silla'], correct:0}
  ];

  const pairBase = ['big|huge','small|tiny','start|begin','quick|fast'];
  const grammarData = [
    {q:'Choose correct: She ___ English every day.', options:['study','studies','studying'], correct:1},
    {q:'Choose connector of contrast.', options:['because','and','although'], correct:2},
    {q:'Choose correct: He ___ to school by bus.', options:['goes','go','going'], correct:0}
  ];

  const wheelTasks = [
    'Say one sentence in present simple about your daily routine.',
    'Write one sentence using because and one using although.',
    'Ask for directions politely in English.',
    'Give one prediction about tomorrow using will.',
    'Say 3 healthy habits using should.'
  const spellingData = [
    {scrambled:'CAVYBULARO', answer:'VOCABULARY'},
    {scrambled:'NETSENCE', answer:'SENTENCE'},
    {scrambled:'NORTISATLNA', answer:'TRANSLATION'}
  ];

  const anagrams = [
    {scrambled:'LEAPP', answer:'APPLE'},
    {scrambled:'RYECCL', answer:'RECYCLE'},
    {scrambled:'MOREHOKW', answer:'HOMEWORK'},
    {scrambled:'TACOHB', answer:'CHATBOT'}
  const pronData = [
    {q:'Which word has /Œ∏/ sound (th as in think)?', options:['think','this','very'], correct:0},
    {q:'Which word starts with /v/?', options:['berry','vocabulary','weather'], correct:1},
    {q:'Where is stress in translation?', options:['TRANS-lation','trans-LA-tion','transla-TION'], correct:1}
  ];

  function persist(){
    localStorage.setItem('pitGamesV4', JSON.stringify({score:state.score, stars:state.stars, best:state.best}));
  }
  const orderData = [
    {q:'Choose correct order.', options:['Always I read at night.','I always read at night.','I read always at night.'], correct:1},
    {q:'Choose correct order.', options:['She usually arrives on time.','Usually she arrives on time.','She arrives usually on time.'], correct:0},
    {q:'Choose correct order.', options:['We often play after class.','Often we play after class.','We play often after class.'], correct:0}
  ];

  const idx = {v:0,g:0,s:0,p:0,o:0};

  function hud(){
    document.getElementById('score').textContent = state.score;
    document.getElementById('stars').textContent = state.stars;
    document.getElementById('best').textContent = state.best;
  }

  function tip(text){
    document.getElementById('tip').textContent = text;
  }

  function addScore(points, app){
    state.score += points;
    if(app) state.best = app;
    hud();
    persist();
  }

  function addStar(app){
    state.stars += 1;
    state.best = app;
    hud();
    persist();
  }
  function addPoints(n){ state.score += n; hud(); }
  function addStar(){ state.stars += 1; hud(); }

  function startTimer(){
    if(state.timerRef) return;
    state.timerRef = setInterval(()=>{
      if(state.paused) return;
      state.seconds++;
      const m = String(Math.floor(state.seconds/60)).padStart(2,'0');
      const s = String(state.seconds%60).padStart(2,'0');
      document.getElementById('timer').textContent = `${m}:${s}`;
    },1000);
  }

  function activatePanel(panel){
  function activate(panel, title){
    document.querySelectorAll('.panel').forEach(p=>p.classList.remove('active'));
    document.getElementById(`panel-${panel}`).classList.add('active');
    document.querySelectorAll('.gameBtn').forEach(b=>b.classList.remove('active'));
    document.querySelector(`.gameBtn[data-panel="${panel}"]`).classList.add('active');
  }

  // Quiz app
  function renderQuiz(){
    const q = quizData[state.quizIndex];
    state.quizAnswered = false;
    document.getElementById('quizQuestion').textContent = `Q${state.quizIndex+1}/3 ‚Äî ${q.q}`;
    document.getElementById('quizAnswers').innerHTML = q.options.map((opt,i)=>`<button data-i="${i}">${opt}</button>`).join('');
    document.getElementById('quizFeedback').textContent = '';
    document.getElementById('quizFeedback').className = 'feedback';
    document.getElementById('quizNext').disabled = true;

    document.querySelectorAll('#quizAnswers button').forEach(btn=>{
      btn.addEventListener('click',()=>answerQuiz(Number(btn.dataset.i)));
    });
    document.querySelectorAll('.menuBtn').forEach(b=>b.classList.remove('active'));
    document.querySelector(`.menuBtn[data-panel="${panel}"]`).classList.add('active');
    document.getElementById('currentGame').textContent = title;
  }

  function answerQuiz(choice){
    if(state.quizAnswered) return;
    state.quizAnswered = true;
    const q = quizData[state.quizIndex];
    const fb = document.getElementById('quizFeedback');

    document.querySelectorAll('#quizAnswers button').forEach((btn,i)=>{
      btn.disabled = true;
      if(i === q.correct) btn.classList.add('correct');
      if(i === choice && choice !== q.correct) btn.classList.add('wrong');
    });

    if(choice === q.correct){
      state.quizCorrect++;
      addScore(10,'Quiz');
      fb.textContent = '‚úÖ Correct! +10';
      fb.className = 'feedback ok';
    } else {
      fb.textContent = `‚ùå Wrong. Correct: ${q.options[q.correct]}`;
      fb.className = 'feedback bad';
    }

    document.getElementById('quizNext').disabled = false;
  function renderMCQ(qObj, qEl, answersEl, fbEl){
    document.getElementById(qEl).textContent = qObj.q;
    document.getElementById(fbEl).textContent = '';
    document.getElementById(fbEl).className = 'feedback';
    document.getElementById(answersEl).innerHTML = qObj.options.map((o,i)=>`<button data-i="${i}">${o}</button>`).join('');
    return document.querySelectorAll(`#${answersEl} button`);
  }

  function nextQuiz(){
    if(state.quizIndex < quizData.length - 1){
      state.quizIndex++;
      renderQuiz();
      return;
    }

    const passed = state.quizCorrect >= 2;
    const fb = document.getElementById('quizFeedback');
    if(passed){
      addStar('Quiz');
      addScore(20,'Quiz');
      fb.textContent = `üèÜ Quiz cleared (${state.quizCorrect}/3). Star earned.`;
      fb.className = 'feedback ok';
    } else {
      fb.textContent = `‚ö†Ô∏è Quiz result ${state.quizCorrect}/3. Need 2/3 for a star.`;
      fb.className = 'feedback bad';
    }
    document.getElementById('quizNext').disabled = true;
  }

  function restartQuiz(){
    state.quizIndex = 0;
    state.quizCorrect = 0;
    renderQuiz();
  function bindCheck(buttons, qObj, fbEl){
    buttons.forEach(btn=>btn.addEventListener('click',()=>{
      const choice = Number(btn.dataset.i);
      buttons.forEach(b=>b.disabled = true);
      const fb = document.getElementById(fbEl);
      if(choice === qObj.correct){
        fb.textContent = '‚úÖ Correct +10';
        fb.className = 'feedback ok';
        addPoints(10);
      } else {
        fb.textContent = `‚ùå Incorrect. Correct: ${qObj.options[qObj.correct]}`;
        fb.className = 'feedback bad';
      }
    }));
  }

  // Matching pairs app
  function setupPairs(){
    const deck = [];
    pairBase.forEach((pair,idx)=>{
      const [a,b] = pair.split('|');
      deck.push({id:`${idx}a`,pair:idx,text:a,open:false,matched:false});
      deck.push({id:`${idx}b`,pair:idx,text:b,open:false,matched:false});
    });
    state.pairsDeck = deck.sort(()=>Math.random()-0.5);
    state.pairsOpen = [];
    document.getElementById('pairsFeedback').textContent = '';
    drawPairs();
  function showVocab(){
    const q = vocabData[idx.v % vocabData.length];
    const buttons = renderMCQ(q,'vocabQuestion','vocabAnswers','vocabFeedback');
    bindCheck(buttons,q,'vocabFeedback');
  }

  function drawPairs(){
    const board = document.getElementById('pairsBoard');
    board.innerHTML = state.pairsDeck.map((card,i)=>`<button class="pairCard ${card.open?'open':''} ${card.matched?'matched':''}" data-i="${i}">${(card.open||card.matched)?card.text:'?'}</button>`).join('');
    board.querySelectorAll('button').forEach(btn=>btn.addEventListener('click',()=>flipPair(Number(btn.dataset.i))));
  function showGrammar(){
    const q = grammarData[idx.g % grammarData.length];
    const buttons = renderMCQ(q,'grammarQuestion','grammarAnswers','grammarFeedback');
    bindCheck(buttons,q,'grammarFeedback');
  }

  function flipPair(i){
    const c = state.pairsDeck[i];
    if(!c || c.open || c.matched || state.pairsOpen.length===2) return;

    c.open = true;
    state.pairsOpen.push(c);
    drawPairs();

    if(state.pairsOpen.length===2){
      const [a,b] = state.pairsOpen;
      if(a.pair===b.pair){
        a.matched = true;
        b.matched = true;
        state.pairsOpen = [];
        addScore(12,'Pairs');
        document.getElementById('pairsFeedback').textContent = '‚úÖ Match! +12';
        document.getElementById('pairsFeedback').className = 'feedback ok';
        if(state.pairsDeck.every(x=>x.matched)){
          addStar('Pairs');
          document.getElementById('pairsFeedback').textContent = 'üèÜ All pairs found. Star earned.';
        }
      } else {
        document.getElementById('pairsFeedback').textContent = '‚ùå Not a pair.';
        document.getElementById('pairsFeedback').className = 'feedback bad';
        setTimeout(()=>{
          a.open = false;
          b.open = false;
          state.pairsOpen = [];
          drawPairs();
        },600);
      }
    }
  function showPron(){
    const q = pronData[idx.p % pronData.length];
    const buttons = renderMCQ(q,'pronQuestion','pronAnswers','pronFeedback');
    bindCheck(buttons,q,'pronFeedback');
  }

  // Wheel app
  function spinWheel(){
    const task = wheelTasks[Math.floor(Math.random()*wheelTasks.length)];
    document.getElementById('wheelResult').textContent = task;
    document.getElementById('wheelFeedback').textContent = '‚úÖ Challenge generated. +5 points';
    document.getElementById('wheelFeedback').className = 'feedback ok';
    addScore(5,'Wheel');
  function showOrder(){
    const q = orderData[idx.o % orderData.length];
    const buttons = renderMCQ(q,'orderQuestion','orderAnswers','orderFeedback');
    bindCheck(buttons,q,'orderFeedback');
  }

  // Anagram app
  function renderAnagram(){
    const item = anagrams[state.anagramIndex];
    document.getElementById('anagramWord').textContent = item.scrambled;
    document.getElementById('anagramInput').value = '';
    document.getElementById('anagramFeedback').textContent = '';
    document.getElementById('anagramFeedback').className = 'feedback';
  function showSpelling(){
    const item = spellingData[idx.s % spellingData.length];
    document.getElementById('spellingWord').textContent = item.scrambled;
    document.getElementById('spellingInput').value = '';
    document.getElementById('spellingFeedback').textContent = '';
    document.getElementById('spellingFeedback').className = 'feedback';
  }

  function checkAnagram(){
    const item = anagrams[state.anagramIndex];
    const input = document.getElementById('anagramInput').value.trim().toUpperCase();
    const fb = document.getElementById('anagramFeedback');

    if(!input){
      fb.textContent = 'Type an answer first.';
      fb.className = 'feedback bad';
      return;
    }

  document.querySelectorAll('.menuBtn').forEach(btn=>btn.addEventListener('click',()=>{
    const p = btn.dataset.panel;
    const title = btn.textContent.split('\n')[0].trim();
    activate(p,title);
  }));

  document.getElementById('vocabNext').addEventListener('click',()=>{ idx.v++; showVocab(); if(idx.v===3) addStar(); });
  document.getElementById('grammarNext').addEventListener('click',()=>{ idx.g++; showGrammar(); if(idx.g===3) addStar(); });
  document.getElementById('pronNext').addEventListener('click',()=>{ idx.p++; showPron(); if(idx.p===3) addStar(); });
  document.getElementById('orderNext').addEventListener('click',()=>{ idx.o++; showOrder(); if(idx.o===3) addStar(); });

  document.getElementById('spellingCheck').addEventListener('click',()=>{
    const item = spellingData[idx.s % spellingData.length];
    const input = document.getElementById('spellingInput').value.trim().toUpperCase();
    const fb = document.getElementById('spellingFeedback');
    if(!input){ fb.textContent = 'Type an answer first.'; fb.className='feedback bad'; return; }
    if(input === item.answer){
      fb.textContent = '‚úÖ Correct anagram! +10';
      fb.textContent = '‚úÖ Correct +10';
      fb.className = 'feedback ok';
      addScore(10,'Anagram');
      if(item.answer === 'CHATBOT') addStar('Anagram');
      addPoints(10);
    } else {
      fb.textContent = `‚ùå Not correct. Try again.`;
      fb.textContent = `‚ùå Incorrect. Correct spelling: ${item.answer}`;
      fb.className = 'feedback bad';
    }
  }

  function nextAnagram(){
    state.anagramIndex = (state.anagramIndex + 1) % anagrams.length;
    renderAnagram();
  }
  });

  function resetAll(){
    localStorage.removeItem('pitGamesV4');
    state.score = 0;
    state.stars = 0;
    state.best = '-';
    state.quizIndex = 0;
    state.quizCorrect = 0;
    state.anagramIndex = 0;
    hud();
    restartQuiz();
    setupPairs();
    renderAnagram();
    document.getElementById('wheelResult').textContent = 'Press SPIN to get a challenge.';
    document.getElementById('wheelFeedback').textContent = '';
    tip('Reset complete. Choose an app and play.');
  }
  document.getElementById('spellingNext').addEventListener('click',()=>{ idx.s++; showSpelling(); if(idx.s===3) addStar(); });

  // events
  document.querySelectorAll('.gameBtn').forEach(btn=>{
    btn.addEventListener('click',()=>{
      activatePanel(btn.dataset.panel);
      tip(`Now using ${btn.textContent.split('\n')[0].trim()}.`);
    });
  document.getElementById('pauseBtn').addEventListener('click',()=>{ state.paused = !state.paused; });
  document.getElementById('resetBtn').addEventListener('click',()=>{
    state.score = 0; state.stars = 0; state.seconds = 0;
    idx.v=0; idx.g=0; idx.s=0; idx.p=0; idx.o=0;
    document.getElementById('timer').textContent = '00:00';
    hud(); showVocab(); showGrammar(); showSpelling(); showPron(); showOrder();
    activate('vocab','Vocabulary Match');
  });

  document.getElementById('quizNext').addEventListener('click', nextQuiz);
  document.getElementById('quizRestart').addEventListener('click', restartQuiz);
  document.getElementById('pairsRestart').addEventListener('click', setupPairs);
  document.getElementById('wheelSpin').addEventListener('click', spinWheel);
  document.getElementById('anagramCheck').addEventListener('click', checkAnagram);
  document.getElementById('anagramNext').addEventListener('click', nextAnagram);
  document.getElementById('pauseBtn').addEventListener('click', ()=>{ state.paused = !state.paused; tip(state.paused ? 'Timer paused.' : 'Timer resumed.'); });
  document.getElementById('resetBtn').addEventListener('click', resetAll);

  // init
  hud();
  restartQuiz();
  setupPairs();
  renderAnagram();
  startTimer();
  hud(); showVocab(); showGrammar(); showSpelling(); showPron(); showOrder(); startTimer();
</script>

</body>
</html>
