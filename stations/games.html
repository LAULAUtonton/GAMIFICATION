<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>THE PIT ‚Äì Games Station</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;800&display=swap" rel="stylesheet">
<style>
body{
  margin:0;
  font-family:'Orbitron',sans-serif;
  background:radial-gradient(circle,#dbeafe 0%,#2563eb 55%,#0b1a44 100%);
  color:#0f172a;
}
.wrapper{
  width:92%;
  max-width:1100px;
  margin:28px auto 110px;
  background:#fff;
  border-radius:24px;
  padding:24px;
  box-shadow:0 24px 50px rgba(2,6,23,.45);
}
h1{margin:0 0 8px;color:#1e3a8a;text-align:center;letter-spacing:1.5px}
.sub{margin:0 0 18px;text-align:center;color:#1d4ed8;font-size:13px}
.hud{display:grid;grid-template-columns:repeat(auto-fit,minmax(170px,1fr));gap:10px;margin-bottom:14px}
.box{background:#eff6ff;border:2px solid #60a5fa;border-radius:12px;padding:10px 12px;font-weight:800;color:#1e3a8a}
.progressTrack{height:16px;background:#e5e7eb;border-radius:999px;overflow:hidden;margin-bottom:16px}
.progressFill{height:100%;width:0;background:linear-gradient(90deg,#3b82f6,#22d3ee);transition:.25s}
.tip{background:#ecfeff;border:2px solid #67e8f9;padding:10px 12px;border-radius:12px;font-size:13px;margin-bottom:14px;color:#0f766e}
.levelGrid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px;margin-bottom:16px}
.levelCard{border:2px solid #93c5fd;background:#eff6ff;border-radius:14px;padding:12px}
.levelCard.locked{opacity:.5;filter:grayscale(.25)}
.levelCard h3{margin:0 0 6px;font-size:16px;color:#1e40af}
.levelMeta{font-size:12px;color:#1d4ed8;margin-bottom:8px}
.levelCard button{width:100%;padding:10px;border:0;border-radius:10px;font-family:inherit;font-weight:900;background:#2563eb;color:#fff;cursor:pointer}
.levelCard button:disabled{background:#94a3b8;cursor:not-allowed}
.quiz{display:none;background:#f8fafc;border:2px solid #cbd5e1;border-radius:14px;padding:14px}
.question{margin:0 0 8px;color:#0f172a;font-size:15px}
.answers{display:grid;grid-template-columns:1fr;gap:8px}
.answers button{padding:11px;border-radius:10px;border:2px solid #bfdbfe;background:#fff;color:#1e3a8a;text-align:left;font-family:inherit;font-weight:800;cursor:pointer}
.answers button:hover{background:#eff6ff}
.feedback{margin-top:10px;min-height:20px;font-size:13px;font-weight:800}
.feedback.ok{color:#166534}
.feedback.bad{color:#b91c1c}
.actions{display:flex;gap:10px;margin-top:10px;flex-wrap:wrap}
.actions button{padding:10px 14px;border-radius:10px;border:0;font-family:inherit;font-weight:900;cursor:pointer}
.primary{background:#2563eb;color:#fff}
.secondary{background:#e2e8f0;color:#0f172a}
.fixed-bar{position:fixed;left:0;bottom:0;width:100%;background:#0f172a;border-top:2px solid #1e293b;padding:10px;display:flex;justify-content:center;gap:10px;z-index:20}
.fixed-bar button{border:0;border-radius:10px;padding:10px 14px;font-family:inherit;font-weight:900;background:#dbeafe;color:#1e3a8a;cursor:pointer}
</style>
</head>
<body>
<div class="wrapper">
  <h1>GAMES STATION</h1>
  <p class="sub">Challenge Mode ‚Ä¢ Companion of Reading, Writing, Listening, Speaking, Grammar, and Vocabulary</p>

  <div class="hud">
    <div class="box">LEVEL: <span id="levelLabel">1</span>/6</div>
    <div class="box">SCORE: <span id="score">0</span></div>
    <div class="box">STREAK: <span id="streak">0</span></div>
    <div class="box">TIME: <span id="timer">00:00</span></div>
  </div>

  <div class="progressTrack"><div class="progressFill" id="progressFill"></div></div>
  <div class="tip"><strong>Tip:</strong> <span id="tipText">Pass each level with at least 70% to unlock the next one.</span></div>

  <div id="levelGrid" class="levelGrid"></div>

  <div id="quizBox" class="quiz">
    <p class="question" id="questionText"></p>
    <div id="answers" class="answers"></div>
    <div id="feedback" class="feedback"></div>
    <div class="actions">
      <button class="primary" id="nextBtn" onclick="nextQuestion()" disabled>Next</button>
      <button class="secondary" onclick="exitLevel()">Exit Level</button>
    </div>
  </div>
</div>

<div class="fixed-bar">
  <button onclick="location.href='../index.html'">Main Menu</button>
  <button onclick="resetProgress()">Reset Progress</button>
  <button onclick="togglePause()">Pause/Resume Timer</button>
</div>

<script>
const levels = [
  {
    id:1,
    skill:'Vocabulary',
    title:'Word Master Sprint',
    questions:[
      {q:'Choose the synonym of "huge".', options:['tiny','massive','narrow','soft'], correct:1},
      {q:'Pick the correct word: "I ____ homework every evening."', options:['do','make','play','take'], correct:0},
      {q:'Opposite of "noisy" is...', options:['bright','silent','heavy','dirty'], correct:1}
    ]
  },
  {
    id:2,
    skill:'Grammar',
    title:'Grammar Gate',
    questions:[
      {q:'Choose the correct sentence.', options:['She go to school daily.','She goes to school daily.','She going to school daily.','She gone to school daily.'], correct:1},
      {q:'Past simple of "eat" is...', options:['eated','ate','eaten','eat'], correct:1},
      {q:'Complete: "They ____ playing now."', options:['is','am','are','be'], correct:2}
    ]
  },
  {
    id:3,
    skill:'Reading',
    title:'Reading Detective',
    questions:[
      {q:'Text: "Lina missed the bus, so she walked to school." Why was she late?', options:['She overslept','She walked','She missed the bus','She forgot her bag'], correct:2},
      {q:'Text: "The sign said: Library closes at 6 PM." Best conclusion?', options:['It opens at 6 PM','It is open all night','It shuts at 6 PM','It shuts at noon'], correct:2},
      {q:'Text: "Although it rained, the match continued." This means...', options:['Rain stopped the match','The match kept going','No rain fell','The match was canceled'], correct:1}
    ]
  },
  {
    id:4,
    skill:'Listening Logic',
    title:'Audio Sense (Text Sim)',
    questions:[
      {q:'Heard line: "Turn left at the museum." What is the direction?', options:['Go right','Go straight','Turn left','Turn back'], correct:2},
      {q:'Heard line: "I was studying when you called." Main tense pattern?', options:['Past continuous + past simple','Present simple + present continuous','Future + present','Past perfect only'], correct:0},
      {q:'Heard line: "Could you repeat that, please?" Speaker wants to...', options:['end conversation','ask for repetition','give directions','apologize'], correct:1}
    ]
  },
  {
    id:5,
    skill:'Writing',
    title:'Sentence Builder',
    questions:[
      {q:'Best topic sentence for a paragraph about healthy habits?', options:['I have many pencils.','Healthy habits improve our daily life.','Yesterday was cloudy.','Music is very loud.'], correct:1},
      {q:'Choose the best connector for contrast.', options:['because','and','although','so'], correct:2},
      {q:'Which sentence is properly punctuated?', options:['first i wake up then i eat','First, I wake up. Then, I eat.','First I wake up then I eat','first, I wake up then i eat'], correct:1}
    ]
  },
  {
    id:6,
    skill:'Speaking Strategy',
    title:'Conversation Boss',
    questions:[
      {q:'Best response: "How are you feeling today?"', options:['Blue.','I feeling fine.','I am feeling great, thanks.','Yesterday.'], correct:2},
      {q:'For clear speaking, you should...', options:['speak too fast','skip endings','use pauses and stress key words','avoid eye contact always'], correct:2},
      {q:'If you did not understand, best phrase is...', options:['Never mind.','Can you say that again, please?','Bye.','I know everything.'], correct:1}
    ]
  }
];

let state = {
  unlocked: 1,
  score: 0,
  streak: 0,
  activeLevel: null,
  qIndex: 0,
  correctCount: 0,
  answered: false,
  seconds: 0,
  paused: false,
  timerRef: null
};

function saveState(){
  localStorage.setItem('pitGamesStationState', JSON.stringify({
    unlocked: state.unlocked,
    score: state.score,
    streak: state.streak
  }));
}

function loadState(){
  const raw = localStorage.getItem('pitGamesStationState');
  if(!raw) return;
  try{
    const parsed = JSON.parse(raw);
    state.unlocked = Math.min(Math.max(parsed.unlocked || 1, 1), levels.length);
    state.score = parsed.score || 0;
    state.streak = parsed.streak || 0;
  } catch {
    // ignore corrupted storage
  }
}

function startTimer(){
  if(state.timerRef) return;
  state.timerRef = setInterval(()=>{
    if(state.paused) return;
    state.seconds++;
    const m = String(Math.floor(state.seconds/60)).padStart(2,'0');
    const s = String(state.seconds%60).padStart(2,'0');
    document.getElementById('timer').textContent = `${m}:${s}`;
  },1000);
}

function togglePause(){
  state.paused = !state.paused;
  setTip(state.paused ? 'Timer paused.' : 'Timer resumed. Keep pushing levels!');
}

function setTip(text){
  document.getElementById('tipText').textContent = text;
}

function renderHUD(){
  document.getElementById('score').textContent = state.score;
  document.getElementById('streak').textContent = state.streak;
  document.getElementById('levelLabel').textContent = state.unlocked;
  const pct = Math.round((state.unlocked-1)/levels.length*100);
  document.getElementById('progressFill').style.width = `${pct}%`;
}

function renderLevels(){
  const grid = document.getElementById('levelGrid');
  grid.innerHTML = levels.map(level=>{
    const locked = level.id > state.unlocked;
    return `
      <div class="levelCard ${locked ? 'locked' : ''}">
        <h3>Level ${level.id}: ${level.title}</h3>
        <div class="levelMeta">Skill: ${level.skill} ‚Ä¢ 3 Questions ‚Ä¢ Pass 70%</div>
        <button ${locked ? 'disabled' : ''} onclick="startLevel(${level.id})">${locked ? 'Locked' : 'Start Level'}</button>
      </div>
    `;
  }).join('');
}

function startLevel(id){
  const level = levels.find(l=>l.id===id);
  if(!level) return;
  state.activeLevel = level;
  state.qIndex = 0;
  state.correctCount = 0;
  state.answered = false;
  document.getElementById('quizBox').style.display = 'block';
  setTip(`Level ${id}: ${level.skill}. Stay accurate to keep your streak.`);
  renderQuestion();
  startTimer();
}

function renderQuestion(){
  const q = state.activeLevel.questions[state.qIndex];
  document.getElementById('questionText').textContent = `Q${state.qIndex+1}/3 ‚Äî ${q.q}`;
  const answers = document.getElementById('answers');
  answers.innerHTML = q.options.map((opt,idx)=>`<button onclick="selectAnswer(${idx})">${opt}</button>`).join('');
  document.getElementById('feedback').textContent = '';
  document.getElementById('feedback').className = 'feedback';
  document.getElementById('nextBtn').disabled = true;
  state.answered = false;
}

function selectAnswer(choice){
  if(state.answered) return;
  state.answered = true;
  const q = state.activeLevel.questions[state.qIndex];
  const fb = document.getElementById('feedback');

  if(choice === q.correct){
    state.correctCount++;
    state.score += 10;
    state.streak += 1;
    fb.textContent = '‚úÖ Correct! +10 points';
    fb.classList.add('ok');
  } else {
    state.streak = 0;
    fb.textContent = `‚ùå Not this time. Correct answer: ${q.options[q.correct]}`;
    fb.classList.add('bad');
  }

  renderHUD();
  document.getElementById('nextBtn').disabled = false;
}

function nextQuestion(){
  if(!state.activeLevel) return;
  if(state.qIndex < state.activeLevel.questions.length - 1){
    state.qIndex++;
    renderQuestion();
    return;
  }
  finishLevel();
}

function finishLevel(){
  const total = state.activeLevel.questions.length;
  const ratio = state.correctCount / total;
  const passed = ratio >= 0.7;
  const bonus = passed ? 20 : 0;
  if(passed) state.score += bonus;

  if(passed && state.unlocked < levels.length && state.activeLevel.id === state.unlocked){
    state.unlocked++;
  }

  saveState();
  renderHUD();
  renderLevels();

  const pct = Math.round(ratio*100);
  const fb = document.getElementById('feedback');
  fb.textContent = passed
    ? `üèÜ Level cleared (${pct}%). Bonus +${bonus}. Next level unlocked!`
    : `‚ö†Ô∏è Level not cleared (${pct}%). Reach 70% to unlock next level.`;
  fb.className = `feedback ${passed ? 'ok' : 'bad'}`;

  setTip(passed
    ? 'Great job! Try the next level to train another skill.'
    : 'Retry this level, focus on accuracy, then progress.');

  document.getElementById('nextBtn').disabled = true;
}

function exitLevel(){
  state.activeLevel = null;
  document.getElementById('quizBox').style.display = 'none';
  setTip('Choose a level to continue your all-skills challenge.');
}

function resetProgress(){
  localStorage.removeItem('pitGamesStationState');
  state.unlocked = 1;
  state.score = 0;
  state.streak = 0;
  state.activeLevel = null;
  state.qIndex = 0;
  state.correctCount = 0;
  document.getElementById('quizBox').style.display = 'none';
  renderHUD();
  renderLevels();
  setTip('Progress reset. Start from Level 1 again.');
}

loadState();
renderHUD();
renderLevels();
startTimer();
</script>
</body>
</html>
