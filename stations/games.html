<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>THE PIT ‚Äì Games Station Arcade</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;800&display=swap" rel="stylesheet">
<style>
body{margin:0;font-family:'Orbitron',sans-serif;background:radial-gradient(circle,#dbeafe 0%,#2563eb 55%,#0b1a44 100%);color:#0f172a}
.wrapper{width:94%;max-width:1160px;margin:24px auto 110px;background:#fff;border-radius:24px;padding:22px;box-shadow:0 24px 50px rgba(2,6,23,.45)}
h1{margin:0 0 6px;color:#1e3a8a;text-align:center}
.sub{margin:0 0 14px;text-align:center;font-size:13px;color:#1d4ed8}
.hud{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:8px;margin-bottom:10px}
.box{background:#eff6ff;border:2px solid #60a5fa;border-radius:12px;padding:9px 12px;font-weight:800;color:#1e3a8a}
.tip{background:#ecfeff;border:2px solid #67e8f9;border-radius:12px;padding:10px 12px;font-size:13px;color:#0f766e;margin-bottom:12px}
.menuGrid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px}
.gameCard{background:#eff6ff;border:2px solid #93c5fd;border-radius:14px;padding:12px}
.gameCard h3{margin:0 0 6px;color:#1e40af}
.gameCard p{margin:0 0 10px;font-size:12px;color:#1d4ed8;line-height:1.35}
.gameCard button,.actionBtn{border:0;border-radius:10px;padding:10px 14px;font-family:inherit;font-weight:900;cursor:pointer;background:#2563eb;color:#fff}
.panel{display:none;background:#f8fafc;border:2px solid #cbd5e1;border-radius:14px;padding:14px;margin-top:14px}
.panel h2{margin:0 0 8px;color:#1e3a8a}
.actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
.muted{background:#e2e8f0;color:#0f172a}
.feedback{margin-top:8px;min-height:20px;font-size:13px;font-weight:800}
.ok{color:#166534}.bad{color:#b91c1c}
.memoryGrid{display:grid;grid-template-columns:repeat(4,minmax(80px,1fr));gap:8px;margin-top:10px}
.memoryCard{height:78px;border-radius:10px;border:2px solid #bfdbfe;background:#dbeafe;display:flex;align-items:center;justify-content:center;font-size:12px;text-align:center;cursor:pointer;padding:6px}
.memoryCard.open,.memoryCard.matched{background:#fff}
.memoryCard.matched{border-color:#86efac}
.invaderQuestion{margin:8px 0;font-size:14px}
.invaderLane{display:grid;grid-template-columns:repeat(auto-fit,minmax(130px,1fr));gap:8px}
.invader{border:2px solid #bfdbfe;border-radius:10px;padding:12px;background:#fff;color:#1e3a8a;cursor:pointer;font-family:inherit;font-weight:800}
.invader:hover{background:#eff6ff}
.timeBar{height:10px;background:#e5e7eb;border-radius:999px;overflow:hidden;margin:8px 0}
.timeFill{height:100%;width:100%;background:linear-gradient(90deg,#22d3ee,#3b82f6)}
.whackGrid{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;max-width:420px}
.hole{height:88px;background:#dbeafe;border:2px solid #93c5fd;border-radius:14px;display:flex;align-items:center;justify-content:center;font-size:12px;cursor:pointer;padding:6px;text-align:center}
.hole.active{background:#fef3c7;border-color:#f59e0b}
.chompWrap{margin-top:10px}
.chompTrack{display:grid;grid-template-columns:repeat(8,1fr);gap:8px}
.chompCell{height:58px;border:2px solid #bfdbfe;border-radius:10px;background:#fff;display:flex;align-items:center;justify-content:center;font-size:12px;text-align:center;position:relative;padding:4px}
.pitman{position:absolute;left:4px;top:4px;font-size:18px}
.fixed-bar{position:fixed;left:0;bottom:0;width:100%;background:#0f172a;border-top:2px solid #1e293b;padding:10px;display:flex;justify-content:center;gap:10px;z-index:30}
.fixed-bar button{border:0;border-radius:10px;padding:10px 14px;font-family:inherit;font-weight:900;background:#dbeafe;color:#1e3a8a;cursor:pointer}
</style>
</head>
<body>
<div class="wrapper">
  <h1>GAMES STATION ARCADE</h1>
  <p class="sub">Choose your style: Card Games, Space Invaders, Guacamole Whack, or Comecocos.</p>

  <div class="hud">
    <div class="box">SCORE: <span id="score">0</span></div>
    <div class="box">LEVEL STARS: <span id="stars">0</span></div>
    <div class="box">TIME: <span id="timer">00:00</span></div>
    <div class="box">BEST GAME: <span id="bestGame">-</span></div>
  </div>

  <div class="tip"><strong>Tip:</strong> <span id="tipText">Pick a game type you enjoy, then beat it for stars.</span></div>

  <div id="menu" class="menuGrid">
    <div class="gameCard">
      <h3>üÉè Card Match Arena</h3>
      <p>Memory game companion for vocabulary and grammar chunks. Match each word with its pair.</p>
      <button onclick="startGame('cards')">Play Card Game</button>
    </div>
    <div class="gameCard">
      <h3>üöÄ Space Invaders Grammar</h3>
      <p>Aliens descend as answer options. Blast the correct grammar answer before the timer runs out.</p>
      <button onclick="startGame('space')">Play Space Invaders</button>
    </div>
    <div class="gameCard">
      <h3>ü•ë Guacamole Whack</h3>
      <p>Whack only the target word type (e.g., verbs). Build combo streaks for bonus score.</p>
      <button onclick="startGame('whack')">Play Guacamole</button>
    </div>
    <div class="gameCard">
      <h3>üëæ Comecocos Run</h3>
      <p>Move your comecocos and eat only correct tokens from each skill challenge track.</p>
      <button onclick="startGame('comecocos')">Play Comecocos</button>
    </div>
  </div>

  <section id="cardsPanel" class="panel">
    <h2>üÉè Card Match Arena</h2>
    <p>Match pairs to clear the board.</p>
    <div id="memoryGrid" class="memoryGrid"></div>
    <div id="cardsFeedback" class="feedback"></div>
    <div class="actions">
      <button class="actionBtn" onclick="setupCards()">Restart Cards</button>
      <button class="actionBtn muted" onclick="backToMenu()">Back to Arcade</button>
    </div>
  </section>

  <section id="spacePanel" class="panel">
    <h2>üöÄ Space Invaders Grammar</h2>
    <p id="spacePrompt" class="invaderQuestion"></p>
    <div class="timeBar"><div id="spaceTimeFill" class="timeFill"></div></div>
    <div id="spaceLane" class="invaderLane"></div>
    <div id="spaceFeedback" class="feedback"></div>
    <div class="actions">
      <button id="spaceNext" class="actionBtn" onclick="nextSpaceQuestion()" disabled>Next Wave</button>
      <button class="actionBtn muted" onclick="backToMenu()">Back to Arcade</button>
    </div>
  </section>

  <section id="whackPanel" class="panel">
    <h2>ü•ë Guacamole Whack</h2>
    <p id="whackPrompt"></p>
    <div id="whackGrid" class="whackGrid"></div>
    <div id="whackFeedback" class="feedback"></div>
    <div class="actions">
      <button class="actionBtn" onclick="startWhack()">Restart Guacamole</button>
      <button class="actionBtn muted" onclick="backToMenu()">Back to Arcade</button>
    </div>
  </section>

  <section id="comecocosPanel" class="panel">
    <h2>üëæ Comecocos Run</h2>
    <p id="comecocosPrompt">Use LEFT/RIGHT arrows to move. Press SPACE to eat current token.</p>
    <div class="chompWrap">
      <div id="chompTrack" class="chompTrack"></div>
    </div>
    <div id="comecocosFeedback" class="feedback"></div>
    <div class="actions">
      <button class="actionBtn" onclick="startComecocos()">Restart Comecocos</button>
      <button class="actionBtn muted" onclick="backToMenu()">Back to Arcade</button>
    </div>
  </section>
</div>

<div class="fixed-bar">
  <button onclick="location.href='../index.html'">Main Menu</button>
  <button onclick="resetArcade()">Reset Arcade</button>
  <button onclick="togglePause()">Pause/Resume Timer</button>
</div>

<script>
const state = {score:0, stars:0, bestGame:'-', seconds:0, paused:false, timerRef:null, current:'menu'};
const storageKey='pitGamesArcadeState';

function save(){localStorage.setItem(storageKey, JSON.stringify({score:state.score,stars:state.stars,bestGame:state.bestGame}));}
function load(){
  const raw=localStorage.getItem(storageKey);
  if(!raw) return;
  try{const p=JSON.parse(raw); state.score=p.score||0; state.stars=p.stars||0; state.bestGame=p.bestGame||'-';}catch{}
}
function setTip(t){document.getElementById('tipText').textContent=t;}
function hud(){
  document.getElementById('score').textContent=state.score;
  document.getElementById('stars').textContent=state.stars;
  document.getElementById('bestGame').textContent=state.bestGame;
}
function addScore(v){state.score+=v; hud(); save();}
function addStar(game){state.stars+=1; state.bestGame=game; hud(); save();}
function startTimer(){
  if(state.timerRef) return;
  state.timerRef=setInterval(()=>{if(state.paused) return; state.seconds++; const m=String(Math.floor(state.seconds/60)).padStart(2,'0'); const s=String(state.seconds%60).padStart(2,'0'); document.getElementById('timer').textContent=`${m}:${s}`;},1000);
}
function togglePause(){state.paused=!state.paused; setTip(state.paused?'Timer paused.':'Timer resumed.');}

function showPanel(name){
  ['cards','space','whack','comecocos'].forEach(id=>document.getElementById(id+'Panel').style.display='none');
  document.getElementById('menu').style.display='grid';
  if(name!=='menu'){
    document.getElementById('menu').style.display='none';
    document.getElementById(name+'Panel').style.display='block';
  }
  state.current=name;
}

function startGame(name){
  showPanel(name);
  if(name==='cards') setupCards();
  if(name==='space') setupSpace();
  if(name==='whack') startWhack();
  if(name==='comecocos') startComecocos();
  setTip('Beat this game to earn a star.');
}
function backToMenu(){showPanel('menu'); setTip('Pick another game style.');}

/* CARD GAME */
const cardPairs=[
  ['go','went'],['is','are'],['big','huge'],['start','begin'],['happy','glad'],['quickly','fast']
];
let cardDeck=[], openCards=[];
function setupCards(){
  const items=[];
  cardPairs.forEach((p,idx)=>{items.push({pair:idx,text:p[0]}); items.push({pair:idx,text:p[1]});});
  cardDeck=items.sort(()=>Math.random()-0.5).map((x,i)=>({...x,id:i,open:false,matched:false}));
  openCards=[];
  renderCards();
  document.getElementById('cardsFeedback').textContent='';
}
function renderCards(){
  const grid=document.getElementById('memoryGrid');
  grid.innerHTML=cardDeck.map(c=>`<div class="memoryCard ${c.open?'open':''} ${c.matched?'matched':''}" onclick="flipCard(${c.id})">${(c.open||c.matched)?c.text:'?'}</div>`).join('');
}
function flipCard(id){
  const card=cardDeck.find(c=>c.id===id);
  if(!card || card.open || card.matched || openCards.length===2) return;
  card.open=true; openCards.push(card); renderCards();
  if(openCards.length===2){
    const [a,b]=openCards;
    if(a.pair===b.pair){
      a.matched=b.matched=true; openCards=[]; addScore(12);
      document.getElementById('cardsFeedback').textContent='‚úÖ Match! +12';
      if(cardDeck.every(c=>c.matched)){
        addStar('Card Match');
        document.getElementById('cardsFeedback').textContent='üèÜ Board cleared! You earned a star.';
      }
    }else{
      document.getElementById('cardsFeedback').textContent='‚ùå Not a pair.';
      setTimeout(()=>{a.open=false;b.open=false;openCards=[];renderCards();},650);
    }
  }
}

/* SPACE INVADERS */
const spaceQuestions=[
  {q:'Choose correct: She ____ to school every day.',o:['go','goes','going','gone'],c:1},
  {q:'Past simple of "take"',o:['took','taken','takes','take'],c:0},
  {q:'Complete: They ____ playing now.',o:['is','are','be','am'],c:1}
];
let spaceIdx=0, spaceCountdown=null, spaceTime=100;
function setupSpace(){spaceIdx=0; renderSpace();}
function renderSpace(){
  const q=spaceQuestions[spaceIdx];
  document.getElementById('spacePrompt').textContent=`Wave ${spaceIdx+1}/${spaceQuestions.length}: ${q.q}`;
  document.getElementById('spaceLane').innerHTML=q.o.map((x,i)=>`<button class="invader" onclick="shootInvader(${i})">üëæ ${x}</button>`).join('');
  document.getElementById('spaceFeedback').textContent='';
  document.getElementById('spaceNext').disabled=true;
  if(spaceCountdown) clearInterval(spaceCountdown);
  spaceTime=100;
  document.getElementById('spaceTimeFill').style.width='100%';
  spaceCountdown=setInterval(()=>{
    if(state.paused) return;
    spaceTime-=2;
    document.getElementById('spaceTimeFill').style.width=`${Math.max(spaceTime,0)}%`;
    if(spaceTime<=0){
      clearInterval(spaceCountdown);
      document.getElementById('spaceFeedback').textContent='üí• Wave lost. Try next wave.';
      document.getElementById('spaceFeedback').className='feedback bad';
      document.getElementById('spaceNext').disabled=false;
      document.getElementById('spaceLane').innerHTML='';
    }
  },160);
}
function shootInvader(choice){
  const q=spaceQuestions[spaceIdx];
  if(!q) return;
  clearInterval(spaceCountdown);
  if(choice===q.c){
    addScore(15);
    document.getElementById('spaceFeedback').textContent='‚úÖ Direct hit! +15';
    document.getElementById('spaceFeedback').className='feedback ok';
  }else{
    document.getElementById('spaceFeedback').textContent=`‚ùå Wrong alien. Correct: ${q.o[q.c]}`;
    document.getElementById('spaceFeedback').className='feedback bad';
  }
  document.getElementById('spaceNext').disabled=false;
}
function nextSpaceQuestion(){
  spaceIdx++;
  if(spaceIdx<spaceQuestions.length){renderSpace(); return;}
  addStar('Space Invaders');
  document.getElementById('spaceFeedback').textContent='üèÜ Mission complete! Star earned.';
  document.getElementById('spaceFeedback').className='feedback ok';
  document.getElementById('spaceNext').disabled=true;
  document.getElementById('spaceLane').innerHTML='';
}

/* WHACK GUACAMOLE */
const whackWords=['run','apple','sing','table','jump','book','write','chair','swim'];
let whackTarget='verb', whackHits=0, whackTick=null;
function isVerb(w){return ['run','sing','jump','write','swim'].includes(w);}
function startWhack(){
  whackHits=0;
  document.getElementById('whackPrompt').textContent='Whack only VERBS. 12 rounds.';
  document.getElementById('whackFeedback').textContent='';
  renderWhack();
  let round=0;
  if(whackTick) clearInterval(whackTick);
  whackTick=setInterval(()=>{
    if(state.paused) return;
    round++;
    activateRandomHole();
    if(round>=12){
      clearInterval(whackTick);
      if(whackHits>=8){addStar('Guacamole'); addScore(20); document.getElementById('whackFeedback').textContent='üèÜ Great reflexes! Star +20 points.'; document.getElementById('whackFeedback').className='feedback ok';}
      else {document.getElementById('whackFeedback').textContent=`Finished. Hits: ${whackHits}/12 (need 8).`; document.getElementById('whackFeedback').className='feedback bad';}
    }
  },900);
}
function renderWhack(){
  const grid=document.getElementById('whackGrid');
  grid.innerHTML=Array.from({length:9}).map((_,i)=>`<div class="hole" id="hole-${i}" onclick="whack(${i})">-</div>`).join('');
}
function activateRandomHole(){
  for(let i=0;i<9;i++){const el=document.getElementById('hole-'+i); if(!el) continue; el.classList.remove('active'); el.dataset.word=''; el.textContent='-';}
  const idx=Math.floor(Math.random()*9);
  const word=whackWords[Math.floor(Math.random()*whackWords.length)];
  const hole=document.getElementById('hole-'+idx);
  hole.classList.add('active');
  hole.dataset.word=word;
  hole.textContent=word;
}
function whack(i){
  const hole=document.getElementById('hole-'+i);
  if(!hole.classList.contains('active')) return;
  const word=hole.dataset.word;
  if(isVerb(word)){whackHits++; addScore(5); document.getElementById('whackFeedback').textContent=`‚úÖ Nice! Hits ${whackHits}`; document.getElementById('whackFeedback').className='feedback ok';}
  else {document.getElementById('whackFeedback').textContent='‚ùå That was not a verb.'; document.getElementById('whackFeedback').className='feedback bad';}
  hole.classList.remove('active');
  hole.textContent='-';
}

/* COMECOCOS */
let chompPos=0, chompCells=[], chompTarget='adjective', chompScore=0;
const chompWords=['happy','run','blue','swim','small','jump','quiet','eat'];
function isAdjective(w){return ['happy','blue','small','quiet'].includes(w);}
function startComecocos(){
  chompPos=0; chompScore=0;
  chompCells=Array.from({length:8}).map(()=>chompWords[Math.floor(Math.random()*chompWords.length)]);
  document.getElementById('comecocosPrompt').textContent='Target: eat only ADJECTIVES. Use ‚Üê ‚Üí and SPACE.';
  renderComecocos();
  document.getElementById('comecocosFeedback').textContent='';
}
function renderComecocos(){
  const track=document.getElementById('chompTrack');
  track.innerHTML=chompCells.map((w,i)=>`<div class="chompCell">${i===chompPos?'<span class="pitman">üòÆ</span>':''}${w||''}</div>`).join('');
}
function eatCurrent(){
  const w=chompCells[chompPos];
  if(!w) return;
  if(isAdjective(w)){chompScore++; addScore(8); chompCells[chompPos]=''; document.getElementById('comecocosFeedback').textContent=`‚úÖ Ate correct word (${chompScore}/4)`; document.getElementById('comecocosFeedback').className='feedback ok';}
  else {document.getElementById('comecocosFeedback').textContent='‚ùå Wrong token! Avoid verbs.'; document.getElementById('comecocosFeedback').className='feedback bad';}
  renderComecocos();
  if(chompScore>=4){addStar('Comecocos'); document.getElementById('comecocosFeedback').textContent='üèÜ Comecocos cleared! Star earned.';}
}
document.addEventListener('keydown',(e)=>{
  if(state.current!=='comecocos') return;
  if(e.key==='ArrowLeft'){chompPos=Math.max(0,chompPos-1); renderComecocos();}
  if(e.key==='ArrowRight'){chompPos=Math.min(7,chompPos+1); renderComecocos();}
  if(e.key===' '){e.preventDefault(); eatCurrent();}
});

function resetArcade(){
  localStorage.removeItem(storageKey);
  state.score=0; state.stars=0; state.bestGame='-';
  hud();
  backToMenu();
  setTip('Arcade reset. Start from any game you like.');
}

load();
hud();
startTimer();
</script>
</body>
</html>
