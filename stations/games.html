<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>THE PIT – Space Invaders</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;800&display=swap" rel="stylesheet">

<style>
body{
  margin:0;
  font-family:'Orbitron',sans-serif;
  background:radial-gradient(circle,#0ea5e9 0%,#1e3a8a 60%,#020617 100%);
  color:white;
}

.container{
  width:95%;
  max-width:1200px;
  margin:30px auto;
  background:#0f172a;
  padding:20px;
  border-radius:20px;
  box-shadow:0 0 40px rgba(14,165,233,.4);
}

.top{
  display:flex;
  justify-content:space-between;
  flex-wrap:wrap;
  gap:10px;
  margin-bottom:10px;
}

button{
  padding:10px 16px;
  border-radius:12px;
  border:none;
  font-weight:900;
  cursor:pointer;
  font-family:'Orbitron',sans-serif;
}

.btnMain{
  background:#ef4444;
  color:white;
}

.btnControl{
  background:#38bdf8;
  color:#0f172a;
}

canvas{
  width:100%;
  border-radius:14px;
  background:#020617;
  box-shadow:0 0 25px #22d3ee;
}
</style>
</head>

<body>

<div class="container">

<div class="top">
  <div>
    Target: <span id="target">—</span> |
    Score: <span id="score">0</span> |
    Lives: <span id="lives">3</span>
  </div>

  <div>
    <button class="btnControl" id="startBtn">START</button>
    <button class="btnControl" id="pauseBtn">PAUSE</button>
    <button class="btnControl" id="restartBtn">RESTART</button>
    <button class="btnMain" id="backBtn">BACK TO THE PIT</button>
  </div>
</div>

<canvas id="game" width="1000" height="600"></canvas>

</div>

<script>

const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const targetEl = document.getElementById("target");
const scoreEl = document.getElementById("score");
const livesEl = document.getElementById("lives");

const startBtn = document.getElementById("startBtn");
const pauseBtn = document.getElementById("pauseBtn");
const restartBtn = document.getElementById("restartBtn");
const backBtn = document.getElementById("backBtn");

let running=false;
let paused=false;
let animation;

let score=0;
let lives=3;
let direction=1;
let speed=1.5;

const words=["festival","recycle","charity","renewable","community","responsible"];
let targetWord=words[Math.floor(Math.random()*words.length)];

let invaders=[];
let bullets=[];

const player={
  x:canvas.width/2,
  y:canvas.height-60,
  width:80
};

function updateHUD(){
  targetEl.textContent=targetWord;
  scoreEl.textContent=score;
  livesEl.textContent=lives;
}

function createInvaders(){
  invaders=[];
  let startX=150;
  for(let i=0;i<words.length;i++){
    invaders.push({
      word:words[i],
      x:startX+i*130,
      y:120,
      w:120,
      h:60,
      alive:true
    });
  }
}

function drawPlayer(){
  ctx.shadowBlur=20;
  ctx.shadowColor="#22d3ee";
  ctx.fillStyle="#22d3ee";
  ctx.fillRect(player.x-40,player.y,80,20);
  ctx.shadowBlur=0;
}

function drawInvaders(){
  ctx.font="bold 26px Orbitron";
  invaders.forEach(inv=>{
    if(!inv.alive) return;

    ctx.shadowBlur=20;
    ctx.shadowColor="#38bdf8";
    ctx.fillStyle="#1e40af";
    ctx.fillRect(inv.x,inv.y,inv.w,inv.h);

    ctx.strokeStyle="#38bdf8";
    ctx.lineWidth=3;
    ctx.strokeRect(inv.x,inv.y,inv.w,inv.h);

    ctx.shadowBlur=0;
    ctx.fillStyle="white";
    ctx.fillText(inv.word,inv.x+15,inv.y+38);

    inv.x+=speed*direction;
  });

  let left=invaders[0].x;
  let right=invaders[invaders.length-1].x+invaders[0].w;

  if(left<50 || right>canvas.width-50){
    direction*=-1;
    invaders.forEach(inv=>inv.y+=30);
  }
}

function drawBullets(){
  bullets.forEach(b=>{
    b.y-=7;

    ctx.shadowBlur=15;
    ctx.shadowColor="yellow";
    ctx.fillStyle="yellow";
    ctx.beginPath();
    ctx.arc(b.x,b.y,6,0,Math.PI*2);
    ctx.fill();
    ctx.shadowBlur=0;

    invaders.forEach(inv=>{
      if(!inv.alive) return;

      if(b.x>inv.x && b.x<inv.x+inv.w &&
         b.y>inv.y && b.y<inv.y+inv.h){

        inv.alive=false;

        if(inv.word===targetWord){
          score+=10;
        }else{
          lives--;
        }

        targetWord=words[Math.floor(Math.random()*words.length)];
        updateHUD();
      }
    });
  });

  bullets=bullets.filter(b=>b.y>0);
}

function gameLoop(){
  if(!running) return;

  if(paused){
    ctx.fillStyle="white";
    ctx.font="40px Orbitron";
    ctx.fillText("PAUSED",canvas.width/2-100,canvas.height/2);
    animation=requestAnimationFrame(gameLoop);
    return;
  }

  ctx.clearRect(0,0,canvas.width,canvas.height);

  drawPlayer();
  drawInvaders();
  drawBullets();

  if(lives<=0){
    ctx.fillStyle="red";
    ctx.font="50px Orbitron";
    ctx.fillText("GAME OVER",canvas.width/2-170,canvas.height/2);
    running=false;
    return;
  }

  animation=requestAnimationFrame(gameLoop);
}

window.addEventListener("keydown",(e)=>{
  if(e.key==="ArrowLeft") player.x-=20;
  if(e.key==="ArrowRight") player.x+=20;
  if(e.code==="Space") bullets.push({x:player.x,y:player.y});
  if(e.key==="p") paused=!paused;
  if(e.key==="r") restartGame();
  if(e.key==="Escape") goBack();
});

function startGame(){
  if(!running){
    running=true;
    gameLoop();
  }
}

function restartGame(){
  score=0;
  lives=3;
  targetWord=words[Math.floor(Math.random()*words.length)];
  createInvaders();
  updateHUD();
  running=true;
  paused=false;
  gameLoop();
}

function goBack(){
  window.location.href="../index.html";
}

startBtn.onclick=startGame;
pauseBtn.onclick=()=>paused=!paused;
restartBtn.onclick=restartGame;
backBtn.onclick=goBack;

createInvaders();
updateHUD();

</script>
</body>
</html>
