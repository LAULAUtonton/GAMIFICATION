<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>THE PIT – Writing Station</title>

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;800&display=swap" rel="stylesheet">

<style>
body{
  margin:0;
  font-family:'Orbitron',sans-serif;
  background:radial-gradient(circle,#fed7aa 0%,#f97316 60%,#7c2d12 100%);
  color:#111827;
}

.container{
  width:90%;
  max-width:1000px;
  margin:40px auto;
  background:white;
  padding:40px;
  border-radius:25px;
  box-shadow:0 25px 50px rgba(0,0,0,0.6);
}

.title{
  text-align:center;
  font-size:30px;
  color:#9a3412;
  margin-bottom:10px;
}

.topBar{
  display:flex;
  justify-content:space-between;
  flex-wrap:wrap;
  gap:10px;
  margin-bottom:20px;
}

.badge{
  padding:8px 14px;
  border-radius:999px;
  background:#ffedd5;
  border:2px solid #f97316;
  font-size:13px;
  font-weight:800;
}

.button{
  padding:10px 16px;
  border-radius:12px;
  border:none;
  cursor:pointer;
  font-weight:900;
  transition:.2s;
}

.orangeBtn{
  background:#f97316;
  color:white;
}
.orangeBtn:hover{ background:#ea580c; }

.whiteBtn{
  background:white;
  border:2px solid #f97316;
  color:#9a3412;
}
.whiteBtn:hover{ background:#ffedd5; }

textarea{
  width:100%;
  min-height:150px;
  padding:14px;
  border-radius:15px;
  border:2px solid #f97316;
  font-family:Arial;
  font-size:15px;
  margin-top:10px;
}

.feedback{
  margin-top:15px;
  padding:15px;
  border-radius:15px;
  background:#fff7ed;
  border:2px solid #fb923c;
  font-size:14px;
}

.hidden{ display:none; }

.modeBox{
  margin-bottom:25px;
  padding:18px;
  border-radius:18px;
  border:2px solid #fb923c;
  background:#fff7ed;
}

.wordCount{
  margin-top:8px;
  font-size:13px;
  font-weight:800;
  color:#9a3412;
}
</style>
</head>

<body>

<div class="container" id="app">

<div class="title">WRITING STATION</div>

<!-- LOGIN -->
<div id="loginBox">
  <p><strong>Enter your name to begin:</strong></p>
  <input type="text" id="studentNameInput" placeholder="Your name">
  <button class="button orangeBtn" onclick="startLogin()">START</button>
</div>

<!-- MAIN CONTENT -->
<div id="mainContent" class="hidden">

<div class="topBar">
  <div class="badge" id="studentBadge"></div>
  <div class="badge" id="timer">00:00</div>
  <div class="badge" id="modeBadge">Mode: Quick Fix</div>
</div>

<div class="topBar">
  <button class="button whiteBtn" onclick="goMainMenu()">Main Menu</button>
  <button class="button whiteBtn" onclick="pauseTimer()">Pause</button>
  <button class="button whiteBtn" onclick="exitStation()">Exit</button>
  <button class="button orangeBtn" onclick="saveProgress()">Save</button>
</div>

<!-- MODE SELECT -->
<div class="modeBox">
  <button class="button orangeBtn" onclick="setMode('quick')">Quick Fix</button>
  <button class="button orangeBtn" onclick="setMode('transform')">Transform</button>
  <button class="button orangeBtn" onclick="setMode('paragraph')">Build Paragraph</button>
  <button class="button orangeBtn" onclick="setMode('boss')">Boss Level</button>
</div>

<!-- WRITING AREA -->
<div id="writingArea">

  <div id="promptBox"></div>

  <textarea id="writingInput" placeholder="Start writing here..."></textarea>
  <div class="wordCount" id="wordCounter">Words: 0</div>

  <button class="button orangeBtn" onclick="submitWriting()">Submit</button>

  <div id="feedbackBox" class="feedback hidden"></div>

</div>

</div>
</div>

<script>

/* ================= LOGIN ================= */

let studentName = localStorage.getItem("pitStudent");

if(studentName){
  activateApp();
}

function startLogin(){
  const name = document.getElementById("studentNameInput").value.trim();
  if(!name) return alert("Enter your name.");
  localStorage.setItem("pitStudent", name);
  studentName = name;
  activateApp();
}

function activateApp(){
  document.getElementById("loginBox").classList.add("hidden");
  document.getElementById("mainContent").classList.remove("hidden");
  document.getElementById("studentBadge").innerText = "Student: " + studentName;
  startTimer();
}

/* ================= TIMER ================= */

let seconds = 0;
let interval = null;

function startTimer(){
  interval = setInterval(()=>{
    seconds++;
    updateTimer();
  },1000);
}

function pauseTimer(){
  clearInterval(interval);
}

function updateTimer(){
  let m = String(Math.floor(seconds/60)).padStart(2,"0");
  let s = String(seconds%60).padStart(2,"0");
  document.getElementById("timer").innerText = m + ":" + s;
}

/* ================= WORD COUNT ================= */

const input = document.getElementById("writingInput");

input.addEventListener("input", ()=>{
  const words = input.value.trim().split(/\s+/).filter(w=>w.length>0);
  document.getElementById("wordCounter").innerText = "Words: " + words.length;
});

/* ================= MODES ================= */

let currentMode = "quick";

function setMode(mode){
  currentMode = mode;
  document.getElementById("modeBadge").innerText = "Mode: " + mode;
  loadPrompt();
}

function loadPrompt(){
  const promptBox = document.getElementById("promptBox");

  if(currentMode==="quick"){
    promptBox.innerHTML = "<strong>Correct the mistakes:</strong><br>We was very nervous and there was many machines.";
  }
  if(currentMode==="transform"){
    promptBox.innerHTML = "<strong>Rewrite using 'although':</strong><br>We were scared. We continued walking.";
  }
  if(currentMode==="paragraph"){
    promptBox.innerHTML = "<strong>Write a short paragraph (80 words):</strong><br>Describe a mysterious place you visited.";
  }
  if(currentMode==="boss"){
    promptBox.innerHTML = "<strong>Boss Level:</strong><br>Write 100 words about how technology will change schools.";
  }

  input.value="";
  document.getElementById("feedbackBox").classList.add("hidden");
}

/* ================= GRAMMAR CHECK ================= */

function grammarCheck(text){
  let feedback = [];

  if(!text.match(/[A-Z]/)) feedback.push("Start sentences with capital letters.");
  if(!text.match(/[.?!]$/)) feedback.push("End your text with punctuation.");
  if(text.includes("there was many")) feedback.push("Use 'there were' with plural nouns.");
  if(text.includes("we was")) feedback.push("Use 'we were'.");
  if(text.split(" ").length < 5) feedback.push("Write longer sentences.");

  return feedback;
}

/* ================= SUBMIT ================= */

function submitWriting(){
  const text = input.value.trim();
  if(!text) return alert("Write something first.");

  const feedback = grammarCheck(text);
  const box = document.getElementById("feedbackBox");

  if(feedback.length===0){
    box.innerHTML = "✅ Excellent! No major grammar issues detected.";
  } else {
    box.innerHTML = "<strong>Feedback:</strong><br>" + feedback.join("<br>");
  }

  box.classList.remove("hidden");
}

/* ================= SAVE ================= */

function saveProgress(){
  const data = {
    student: studentName,
    mode: currentMode,
    text: input.value,
    time: seconds
  };

  localStorage.setItem("writingProgress", JSON.stringify(data));
  alert("Progress saved.");
}

/* ================= NAVIGATION ================= */

function goMainMenu(){
  window.location.href = "../index.html";
}

function exitStation(){
  pauseTimer();
  window.location.href = "../index.html";
}

/* INIT */
loadPrompt();

</script>

</body>
</html>
